# uniappåŸºç¡€éƒ¨åˆ†

æœ‰æ–‡æ¡£è¿˜çœ‹ä»€ä¹ˆæ•™ç¨‹ï¼Ÿ

å®˜ç½‘æ–‡æ¡£éå¸¸çš„è¯¦ç»†ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰æ¥è§¦è¿‡çš„æ–°äººçœ‹æ–‡æ¡£å…¶å®æ˜¯æ²¡æ³•å­¦çš„ï¼Œå› ä¸ºä»–ä¸çŸ¥é“è¦å®Œæˆä¸€ä¸ªå¼€å‘ï¼Œéœ€è¦å­¦ä¹ é‚£äº›çŸ¥è¯†ç‚¹ï¼Œè€Œä¸”å¦‚ä½•æ­£ç¡®çš„ä½¿ç”¨æ–‡æ¡£ä¹Ÿä¸æ¸…æ¥š

æœ¬æ¬¡å†…å®¹ä¸»è¦æ˜¯ä¸ºåé¢çš„å®æˆ˜è¯¾æ‰“åŸºç¡€ï¼Œå¦‚æœä½ ä¼šçš„è¯å®Œå…¨å¯ä»¥ä¸çœ‹ï¼Œä¹Ÿå¤§å¯ä¸å¿…è¯´ä»€ä¹ˆé£è¨€é£è¯­ï¼Œä½ ä¼šä¸ä»£è¡¨åˆ«äººéƒ½ä¼šï¼Œè¯´è¿™ç§è¯çœŸçš„è®©äººæŒºéš¾å—çš„

å…¶å®æˆ‘æ˜¨å¤©æ™šä¸Šå‡Œæ™¨å·²ç»å½•äº†ä¸€å¥—è§†é¢‘æ˜¯å®Œå…¨ç°åœºçœ‹æ–‡æ¡£å½•çš„ï¼Œæ•ˆæœä¸å¥½ï¼Œè¿˜æ˜¯å¾—å†™ä¸ªç®€å•çš„æ–‡æ¡£æ¥å½•ï¼ˆè‚ğŸ‘ï¼‰

**æœ¬æ¬¡çš„å†…å®¹ä¸»è¦å°±æ˜¯å¸¦ä½ çœ‹æ–‡æ¡£**ï¼Œæ²¡é”™å°±æ˜¯çœ‹æ–‡æ¡£ï¼Œè®©ä½ å­¦ä¼šçœ‹æ–‡æ¡£ï¼Œå¹¶ä¸”æœ‰ä¸ªæ•´ä½“çš„è®¤çŸ¥ 

## å¼€å‘å·¥å…·

é¦–å…ˆuniappå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œçš„æ–¹å¼å¼€å‘ï¼Œç„¶åé€‰æ‹©ä½ å–œæ¬¢çš„å¼€å‘å·¥å…·ï¼Œä½†æ˜¯å¤§å¯ä¸å¿…ï¼Œ[HBuilder X](https://www.dcloud.io/hbuilderx.html)å®Œå…¨èƒ½æ»¡è¶³éœ€æ±‚ï¼Œè®°å¾—ä¸‹è½½appå¼€å‘ç‰ˆæœ¬çš„

å®˜æ–¹ç§°å¯ä»¥åŒæ—¶ç¼–è¯‘åä¸ªå¹³å°ï¼Œä½†æ˜¯å¦‚æœä½ æƒ³è®©æ¯ä¸ªå¹³å°éƒ½æ˜¯åŒæ ·çš„ä½“éªŒçš„è¯ï¼Œä¼°è®¡æ˜¯è¦èŠ±å¾ˆå¤šçš„åŠŸå¤«çš„ï¼›å³ä½¿ä½ åªéœ€è¦å¼€å‘å¾®ä¿¡å°ç¨‹åºä¸€ä¸ªå¹³å°ï¼Œuniappä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©

![image-20201005012909579](https://img.lookroot.cn/blog/202010/05/012910-966766.png)

æˆ‘å¸Œæœ›ä½ æ˜¯ä½¿ç”¨chromeæµè§ˆå™¨çš„ï¼Œæ–°edgeæµè§ˆå™¨ä¹Ÿå¯ä»¥ï¼Œå¦‚æœä½ å¯¹æµè§ˆå™¨è°ƒè¯•æ„Ÿå…´è¶£çš„è¯è¿˜å¯ä»¥çœ‹æˆ‘æ€»ç»“çš„[æµè§ˆå™¨è°ƒè¯•æŠ€å·§](https://www.lookroot.cn/course/chromedevtools/)

ä½ è¿˜å¯ä»¥åœ¨ç”µè„‘ä¸Šå®‰è£…ä¸€ä¸ª Androidçš„è™šæ‹Ÿæœºç”¨æ¥åšå®‰å“ç«¯çš„è°ƒè¯•ï¼Œå®‰è£…å°ç¨‹åºå¼€å‘å·¥å…·ï¼ˆä¸€èˆ¬å®‰è£…å¾®ä¿¡çš„å°±å¯ä»¥äº†ï¼‰

## å‰ç½®çŸ¥è¯†

ä½ æœ€å¥½èƒ½æœ‰vuejsçš„åŸºç¡€çŸ¥è¯†ï¼Œå¦‚æœæ²¡æœ‰ä¹Ÿåˆ«æ€•,å¯ä»¥è·Ÿç€æˆ‘çš„[vueåŸºç¡€æ•™ç¨‹](https://www.lookroot.cn/course/vuebasics/)å­¦ä¹ ï¼ŒèŠ±ä¸äº†å¤šå°‘æ—¶é—´

## è®¤è¯†ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£

![image-20201005224206838](https://img.lookroot.cn/blog/202010/05/224207-836601.png)

- ä»‹ç» ï¼›è¿™ä¸ªéƒ¨åˆ†çš„å†…å®¹æ›´åƒä¸€ä¸ªè¯´æ˜ä¹¦ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹
- æ¡†æ¶ï¼›è¿™ä¸ªéƒ¨åˆ†æ›´å¤šçš„æ˜¯å…³äºæ•´ä¸ªé¡¹ç›®çš„é…ç½®æ–¹é¢çš„ä¸œè¥¿
- ç»„ä»¶ï¼›é¡¹ç›®ä¸­çš„é¡µé¢å®ç°ä¸»è¦çœ‹è¿™ä¸ªéƒ¨åˆ†
- APIï¼›é¡¹ç›®ä¸­çš„é€»è¾‘åŠŸèƒ½ä¸»è¦çœ‹è¿™ä¸ªéƒ¨åˆ†
- unicloudï¼›å°å…¬å¸åˆ©å™¨ï¼Œåé¢ä¼šä¸“é—¨è®²

### æ„å›¾

é¦–å…ˆä½ ä¸€å®šè¦æ˜ç¡®è‡ªå·±çš„æ„å›¾ï¼Œä½¿ç”¨uniappçš„ç›®çš„ï¼Œä¸èƒ½ä¸ºäº†ä¼šä»€ä¹ˆæŠ€æœ¯å»åšä»€ä¹ˆä¸œè¥¿ï¼Œè¦ä¸ºäº†å®ç°ä»€ä¹ˆåŠŸèƒ½å»å­¦ä¹ æŠ€æœ¯

- å¦‚æœä½ æ˜¯æƒ³å¼€å‘ç²¾ç¾çš„ç§»åŠ¨app ä½ å®Œå…¨å¯ä»¥ä½¿ç”¨åŸç”Ÿå°±è¡Œå¼€å‘ flutterä¹Ÿæ˜¯æ›´å¥½çš„é€‰æ‹©

- å¦‚æœä½ åªæ˜¯æƒ³å¼€å‘å°ç¨‹åºï¼Œuniappä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸å¥½çš„é€‰æ‹©

- å¦‚æœä½ æƒ³å¿«é€Ÿä¸Šçº¿ä¸€ä¸ª å°ç¨‹åº+appçš„åº”ç”¨ï¼Œä½ éœ€è¦æå‰åšå¥½å¡«å‘çš„å¿ƒç†å‡†å¤‡
  - uniappç»§æ‰¿äº†weexé‚£ä¸€å¥—ï¼Œå†appç«¯ä½ å¯ä»¥ä½¿ç”¨nvueæ¸²æŸ“ï¼Œçº¯åŸç”Ÿæ¸²æŸ“

## æˆ‘ä»¬è®¤è¯†ä¸€ä¸‹é¡¹ç›®

![image-20201005013906497](https://img.lookroot.cn/blog/202010/05/013907-774422.png)

æ‰“å¼€`manifest.json`å¯ä»¥å¯¹æˆ‘ä»¬çš„é¡¹ç›®è¿›è¡Œé…ç½®ï¼Œä¸è¿‡ç›®å‰ä½ ä¹Ÿä¸èƒ½é…ç½®ä¸ªå•¥ï¼Œå¯ä»¥è®¾ç½®ä¸€ä¸‹h5ç½‘é¡µçš„åç§°æˆ–è€…æ˜¯appç«¯çš„å›¾æ ‡ç­‰ç­‰ï¼Œåé¢éœ€è¦é…ç½®çš„åœ°æ–¹å†è¯´

### page

`pages.json`æ˜¯é¡¹ç›®çš„é¡µé¢é…ç½®ï¼Œå¯èƒ½æ˜¯æˆ‘ä»¬å‰é¢æœ€å¤šé…ç½®çš„åœ°æ–¹ï¼Œ`pages`æ•°ç»„é‡Œé¢æ”¾ç½®çš„å°±æ˜¯ä¸€ä¸ªä¸ªé¡µé¢ï¼Œç¬¬ä¸€é¡¹é…ç½®å°±æ˜¯é»˜è®¤æ‰“å¼€ç¨‹åºçš„é¡µé¢ï¼Œåé¢å¦‚æœæˆ‘ä»¬è°ƒè¯•å“ªä¸ªé¡µé¢ï¼Œä¸ºäº†æ–¹ä¾¿å¯ä»¥æŠŠä»–æ”¾åˆ°ç¬¬ä¸€ä¸ªä½ç½®

### tabBar

å¾ˆå¤šåº”ç”¨åŸºæœ¬çš„æ ‡é…

![image-20201005014342729](https://img.lookroot.cn/blog/202010/05/014343-910732.png)

é…ç½®å®ƒä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºä¸‰ä¸ªé¡µé¢æ¥è¯•ä¸€è¯•ï¼Œåœ¨`pages`æ–‡ä»¶å¤¹é¼ æ ‡å³é”®å¯ä»¥é€‰æ‹©æ–°å»ºé¡µé¢

![image-20201005014439554](https://img.lookroot.cn/blog/202010/05/014440-54348.png)

æ ¹æ®è¿™ä¸ªæ–¹å¼æˆ‘ä»¬æ–°å»º`contentã€list`è¿™ä¸¤ä¸ªé¡µé¢ï¼Œæ¯ä¸ªé¡µé¢çš„æ–‡ä»¶ä¸­æˆ‘ä»¬å°±éšä¾¿å†™ä¸ªæ–‡æœ¬åŒºåˆ«å°±è¡Œäº†ï¼Œuniappçš„é¡µé¢ç»“æ„å’Œvuejsæ˜¯å‡ ä¹ä¸€æ ·çš„

![image-20201005014611690](https://img.lookroot.cn/blog/202010/05/014614-72989.png)

ç„¶åæˆ‘ä»¬åœ¨`static`ç›®å½•ä¸‹æ”¾ç½®ä¸€ä¸ªå›¾æ ‡`icon.png`

åœ¨`page.json`ä¸­é…ç½®æˆ‘ä»¬çš„tabBarï¼Œå¯ä»¥é€šè¿‡`color`å’Œ`selectedColor`æ¥è®¾ç½®é»˜è®¤å’Œé€‰ä¸­çš„å­—ä½“é¢œè‰²ï¼Œ`list`é‡Œé¢å°±æ˜¯æ”¾ç½®çš„å…·ä½“æ¯ä¸ªé€‰é¡¹ï¼Œæ¯ä¸ªé€‰é¡¹é‡Œé¢éœ€è¦é…ç½®`pagePath`é¡µé¢é“¾æ¥,`iconPath`é»˜è®¤å›¾`selectedIconPath`é€‰ä¸­ä»¥åçš„å›¾æ ‡ï¼Œ`text`æ–‡æœ¬

```json
"tabBar": {
	"color": "#7A7E83",
	"selectedColor": "#f55f25",
	"borderStyle": "black",
	"backgroundColor": "#ffffff",
	"list": [{
			"pagePath": "pages/index/index",
			"iconPath": "static/logo.png",
			"selectedIconPath": "static/icon.png",
			"text": "ä¸»é¡µ"
		},
		{
			"pagePath": "pages/list/list",
			"iconPath": "static/logo.png",
			"selectedIconPath": "static/icon.png",
			"text": "åˆ—è¡¨"
		}, {
			"pagePath": "pages/content/content",
			"iconPath": "static/logo.png",
			"selectedIconPath": "static/icon.png",
			"text": "å†…å®¹"
		}
	]
}
```

![image-20201005015111623](https://img.lookroot.cn/blog/202010/05/015113-687820.png)

çœ‹ä¸‹æ•ˆæœ

![image-20201005015136609](https://img.lookroot.cn/blog/202010/05/015137-230890.png)



### å¯¼èˆªæ 

[æ–‡æ¡£](https://uniapp.dcloud.io/collocation/pages?id=customnav)

å½“é¡µé¢çš„é»˜è®¤å¯¼èˆªæ ä¸æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰å¯¼èˆªæ ï¼Œåªéœ€è¦åœ¨è¿™ä¸ªé¡µé¢çš„`page.json`æ ç›®è®¾ç½®ä¸€ä¸‹å°±å¯ä»¥äº†

```json
{
	"path": "pages/index/index",
	"style": {
		"navigationBarTitleText": "uni-app",
		"navigationStyle":"custom"
	}
},
```

æ­¤æ—¶æˆ‘ä»¬çš„å¯¼èˆªæ å°±ä¸è§äº†ï¼Œå¯ä»¥ä½¿ç”¨å®˜æ–¹çš„ç»„ä»¶ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å®ç°ï¼Œè¯¦æƒ…çœ‹ä¸‹æ–¹çš„**ä½¿ç”¨ç»„ä»¶**

### ä½¿ç”¨ç»„ä»¶

uniappçš„ç”Ÿæ€è¿˜æ˜¯ä¸é”™çš„ï¼Œé™¤äº†å®˜æ–¹çš„ `uni-ui`æ’ä»¶å¸‚åœºè¿˜æœ‰å¾ˆå¤šç°æˆçš„ä¸œè¥¿

æˆ‘ä»¬ä¸‹è½½ä¸€ä¸ª[è¿™ä¸ªæ’ä»¶](https://ext.dcloud.net.cn/plugin?id=52)

![image-20201005223810843](https://img.lookroot.cn/blog/202010/05/223810-570807.png)

æ–°ç‰ˆæœ¬çš„uniappæ˜¯ä¸éœ€è¦åšä»»ä½•é…ç½®å¯ä»¥ç›´æ¥ä½¿ç”¨ç¬¬ä¸‰æ–¹ç»„ä»¶çš„

![image-20201005010056921](https://img.lookroot.cn/blog/202010/05/010057-733423.png)

ç›´æ¥åœ¨é¡µé¢ä¸­ä½¿ç”¨è¿™ä¸ªæ’ä»¶ï¼Œç„¶åçœ‹çœ‹æ•ˆæœ

```vue
<uni-nav-bar left-icon="back" left-text="è¿”å›" right-text="èœå•" title="å¯¼èˆªæ ç»„ä»¶"></uni-nav-bar>
```

![image-20201005223931902](https://img.lookroot.cn/blog/202010/05/223932-506230.png)

### ä½¿ç”¨å¾®ä¿¡å°ç¨‹åºçš„ç»„ä»¶

[æ–‡æ¡£](https://uniapp.dcloud.io/frame?id=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e7%bb%84%e4%bb%b6%e6%94%af%e6%8c%81)

æœ‰æ—¶å€™ä½ éœ€è¦çš„ç»„ä»¶ï¼Œuniappæ’ä»¶å¸‚åœºæ²¡æœ‰ï¼Œä½†æ˜¯å¾®ä¿¡å°ç¨‹åºç»„ä»¶é‡Œé¢æœ‰æ€ä¹ˆåŠå‘¢ï¼Œuniappä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨å°ç¨‹åºç»„ä»¶çš„

åœ¨æ ¹ç›®å½•æ–°å»ºä¸€ä¸ª`wxcomponents`æ–‡ä»¶å¤¹ï¼Œé‡Œé¢ç»§ç»­åˆ›å»ºä¸€ä¸ª`wxcomdemo`æ–‡ä»¶å¤¹

åˆ›å»ºä»¥ä¸‹å‡ ä¸ªæ–‡ä»¶

`index.js`

```javascript
Component({
  properties: {
    // è¿™é‡Œå®šä¹‰äº†innerTextå±æ€§ï¼Œå±æ€§å€¼å¯ä»¥åœ¨ç»„ä»¶ä½¿ç”¨æ—¶æŒ‡å®š
    innerText: {
      type: String,
      value: 'default value',
    }
  },
  data: {
    // è¿™é‡Œæ˜¯ä¸€äº›ç»„ä»¶å†…éƒ¨æ•°æ®
    someData: {}
  },
  methods: {
    // è¿™é‡Œæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æ–¹æ³•
    customMethod: function(){}
  }
})
```

`index.json`

```json
{
  "component": true
}
```

`index.wxml`

```html
<view class="inner">
  {{innerText}}
</view>
<slot></slot>
```

`index.wxss`

```css
/* è¿™é‡Œçš„æ ·å¼åªåº”ç”¨äºè¿™ä¸ªè‡ªå®šä¹‰ç»„ä»¶ */
.inner {
  color: red;
}
```

ä»¥ä¸Šè¿™å‡ ä¸ªæ–‡ä»¶ä¾¿ç»„æˆäº†ä¸€ä¸ªæ ‡å‡†çš„å°ç¨‹åºç»„ä»¶äº†ï¼Œè¿™ä¸ªç»„ä»¶çš„æ„æ€å°±æ˜¯ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åå±•ç¤ºå®ƒå­—ä½“ä¸ºçº¢è‰²ï¼Œä¸‹é¢æ¥ä½¿ç”¨è¿™ä¸ªç»„ä»¶å§ï¼

åœ¨éœ€è¦ä½¿ç”¨è¿™ä¸ªç»„ä»¶çš„é¡µé¢çš„`page.json`é¡¹é…ç½®

```json
"path": "pages/index/index",
"style": {
	"navigationBarTitleText": "uni-app",
	"navigationStyle": "custom",
	"usingComponents": {
		"wxcomdemo": "/wxcomponents/wxcomdemo/index"
	}
}
```

ç„¶ååœ¨è¿™ä¸ªé¡µé¢ä¸­ä½¿ç”¨

```vue
<wxcomdemo inner-text="Some text"></wxcomdemo>
```

æ­¤æ—¶æˆ‘ä»¬çœ‹çœ‹æ•ˆæœ

![image-20201005231057422](https://img.lookroot.cn/blog/202010/05/231057-522456.png)

## æ„å»ºä¸€ä¸ªtodolist

### ä½¿ç”¨color ui

å› ä¸ºæ‡’å¾—å†™æ ·å¼ï¼Œæˆ‘ä»¬å¼•å…¥[colorui](https://ext.dcloud.net.cn/plugin?id=239)ï¼Œå¯¼å…¥é¡¹ç›®ä»¥åå¤åˆ¶æ ¹ç›®å½•çš„ `/colorui` æ–‡ä»¶å¤¹åˆ°ä½ çš„æ ¹ç›®å½•

App.vue` å¼•å…¥å…³é”®Css `

```vue
<style>
    @import "colorui/main.css";
    @import "colorui/icon.css";
</style>
```

å¹³æ—¶å¼€å‘çš„æ—¶å€™éœ€è¦ä»€ä¹ˆæ•ˆæœï¼Œæˆ‘ä»¬ç›´æ¥å°†è¿™ä¸ªç¤ºä¾‹é¡¹ç›®è¿è¡Œèµ·æ¥ï¼Œç„¶åå»å¤åˆ¶å®ƒé¡µé¢ä¸­çš„ä»£ç å°±è¡Œ

### åˆ—è¡¨æ¸²æŸ“

æ¯”å¦‚è¿™ä¸ªåˆ—è¡¨å·¦æ»‘å°±é€‚åˆæˆ‘ä»¬çš„é¡µé¢

![image-20201006141045779](https://img.lookroot.cn/blog/202010/06/141046-631570.png)

ç›´æ¥å¤åˆ¶è¿‡æ¥åšä¸‹ä¿®æ”¹ï¼Œé¦–å…ˆå®šä¹‰å‡ ä¸ªéœ€è¦ä½¿ç”¨çš„å±æ€§

```javascript
staticTodoList: [{
		_id: 1,
		_name: "ç¬¬ä¸€ä»¶äº‹",
		_status: false
	},
	{
		_id: 2,
		_name: "ç¬¬äºŒä»¶äº‹",
		_status: true
	},
	{
		_id: 3,
		_name: "ç¬¬ä¸‰ä»¶äº‹",
		_status: false
	}
],
todoList: [],
modalName: null,
listTouchStart: 0,
listTouchDirection: null,
```

åœ¨`onload`çš„æ—¶å€™æˆ‘ä»¬è¦åˆå§‹åŒ–æ•°æ®ï¼Œè¿™ä¸ª`staticTodoList`å°±æ˜¯æˆ‘ä»¬æ¨¡æ‹Ÿçš„é™æ€æ•°æ®

```JavaScript
onLoad() {
	this.todoList = this.staticTodoList;
},
```

ç„¶åä½¿ç”¨åˆšåˆšå¤åˆ¶çš„é¡µé¢ä»£ç æ¸²æŸ“å®ƒ

```vue
<view class="cu-item" 
:class="modalName=='move-box-'+ index?'move-cur':''" 
v-for="(todo,index) in todoList" 
:key="index"
 @touchstart="ListTouchStart" 
 @touchmove="ListTouchMove" 
 @touchend="ListTouchEnd" 
 :data-target="'move-box-' + index">
	<view class="content" >
		<view class="text-grey">{{todo._name}}</view>
	</view>
	<view class="action">
		<switch :checked="todo._status"  :data-_id="todo._id" />
	</view>
	<view class="move">
		<view class="bg-red" >åˆ é™¤</view>
	</view>
</view>
```

å®ƒçš„é¡µé¢ä¸­è¿˜å®šä¹‰äº†å‡ ä¸ªäº‹ä»¶ï¼Œæˆ‘ä»¬ä¹Ÿæ‹·è´è¿‡æ¥

```javascript
ListTouchStart(e) {
	this.listTouchStart = e.touches[0].pageX
},
ListTouchMove(e) {
	this.listTouchDirection = e.touches[0].pageX - this.listTouchStart > 0 ? 'right' : 'left'
},
ListTouchEnd(e) {
	if (this.listTouchDirection == 'left') {
		this.modalName = e.currentTarget.dataset.target
	} else {
		this.modalName = null
	}
	this.listTouchDirection = null
},
```

çœ‹ä¸‹æ•ˆæœ

![image-20201006141627428](https://img.lookroot.cn/blog/202010/06/141628-187411.png)

#### åˆ é™¤å’Œåˆ‡æ¢ï¼ˆå°æŠ€å·§ğŸš²ï¼‰

```vue
<view class="action" >
	<switch :checked="todo._status" @change="switchTodo" :data-_id="todo._id" />
</view>
<view class="move">
	<view class="bg-red" @click="del(todo._id)">åˆ é™¤</view>
</view>
```

è¿™ä¸¤ä¸ªäº‹ä»¶ä¹Ÿéå¸¸ç®€å•ï¼Œä¸»è¦æ˜¯çŠ¶æ€åˆ‡æ¢è¿™é‡Œæœ‰ä¸ªå°é—®é¢˜ï¼Œ`@change`åªèƒ½ä¼ é€’å½“å‰çš„æ˜¯å¦é€‰ä¸­çš„å€¼ï¼Œä¸èƒ½ä¼ é€’å½“å‰é¡¹çš„idå€¼ï¼Œè¿™å°±æ²¡æ³•å¤„ç†æ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥ç»™è¿™ä¸ªèŠ‚ç‚¹ç»‘å®šä¸€ä¸ª`:data-_id="todo._id" `ï¼Œç„¶åé€šè¿‡`e.target.dataset._id`å°±èƒ½å–å‡ºè¿™ä¸ªidå€¼äº†ï¼

```javascript
switchTodo(e) {
	const status = e.target.value;
	const _id = e.target.dataset._id;
	this.todoList = this.todoList.map(todo => {
		if (todo._id == _id) {
			todo._status = status;
		}
		return todo;
	})
	uni.showToast({
		title: status ? "å·²å®Œæˆ" : "å·²å–æ¶ˆ",
		icon: status ? "success" : "none"
	})
},
del(_delId) {
	this.todoList = this.todoList.filter(todo => {
		return todo._id != _delId
	});
},
```

### mixin

vueä¸­çš„mixinåŒæ ·çš„ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œé¢ä½¿ç”¨ï¼Œä¸çŸ¥é“è¿™ä¸ªä¸œè¥¿çš„æœ‹å‹ï¼Œå¯ä»¥ç†è§£ä¸ºå…¬ç”¨é€»è¾‘æŠ½ç¦»ï¼Œéœ€è¦ä½¿ç”¨çš„åœ°æ–¹ç›´æ¥å¼•å…¥å°±å¯ä»¥äº†

æ¯”å¦‚`Toast`è¿™ä¸ªæ¶ˆæ¯é€šçŸ¥ç»å¸¸ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å°è£…ä¸€ä¸‹ï¼Œæ–°å»ºä¸€ä¸ª`mixin/message.js`

```javascript
module.exports = {
	methods: {
		toast(message, duration, success) {
			uni.showToast({
				title: message,
				icon: success ? "success" : "none",
				duration: duration
			})
		},
	},
};
```

ä½¿ç”¨å®ƒ

```vue
import message from "@/mixin/message.js"
export default {
		... ... 
		mixins: [message],
		... ... 
}
```

ç„¶åå¯ä»¥ç›´æ¥é€šè¿‡`this.toast("ä¸èƒ½ä¸ºç©º", 2000, false);`æ¥ä½¿ç”¨

### è¡¨å•

æ–°å¢todoçš„åŠŸèƒ½ï¼Œè¿˜æ˜¯å»coloruIçš„é¡¹ç›®é‡Œé¢æ‹·è´ formçš„æ¨¡æ¿ä»£ç 

```vue
<form @submit="add" @reset="clear">
	<view class="cu-form-group margin-top">
		<view class="title">æ–°å¢</view>
		<input placeholder="todo" name="_name"></input>
	</view>
	<view class="padding flex flex-direction">
		<button form-type="submit" class="cu-btn bg-blue lg">ä¿å­˜</button>
		<button form-type="reset" class="cu-btn bg-red margin-tb-sm lg">æ¸…ç©º</button>
	</view>
</form>
```

è¿™ä¸ªæ·»åŠ å’Œæ¸…ç©ºäº‹ä»¶ä¹Ÿéå¸¸ç®€å•

```javascript
add(e) {
	let _name = e.detail.value._name;
	if (_name === null || _name === "") {
		this.toast("ä¸èƒ½ä¸ºç©º", 2000, false);
		return;
	}
	const _id = this.todoList.length > 0 ? this.todoList[this.todoList.length - 1]._id + 1 : 1;
	this.todoList.push({
		_id: _id,
		_name: _name,
		_status: false
	});
	this.toast("æ·»åŠ æˆåŠŸ,_id:" + _id,1000,true)
	e.detail.value = null;
},
clear() {
}
```

![image-20201006142026519](https://img.lookroot.cn/blog/202010/06/142028-603838.png)

### æ•°æ®ç¼“å­˜

åˆ é™¤ä»¥åæˆ‘ä»¬åˆ·æ–°é¡µé¢æ•°æ®åˆå›æ¥äº†ï¼Œå¯ä»¥è¯•ä¸€ä¸‹æ•°æ®ç¼“å­˜ï¼ˆçœŸå®å¼€å‘ï¼Œè¿™äº›éƒ½æ˜¯åç«¯è¿”å›ï¼‰

æˆ‘ä»¬åœ¨`switchTodoã€delã€add`è¿™ä¸‰ä¸ªäº‹ä»¶é‡Œé¢æˆ‘ä»¬éƒ½æ·»åŠ ä¸€ä¸ªç¼“å­˜ï¼Œå°†æœ€æ–°æ•°æ®ç¼“å­˜åˆ°æœ¬åœ°

```javascript
uni.setStorageSync("todolist", this.todoList);
```

ç„¶ååœ¨é¡µé¢å¯åŠ¨çš„æ—¶å€™åŠ è½½è¿™ä¸ªç¼“å­˜

```javascript
onLoad() {
	const todolist = uni.getStorageSync("todolist")
	if (todolist != "") {
		this.todoList = uni.getStorageSync("todolist");
	} else {
		this.todoList = this.staticTodoList;
	}
},
```

### é¡µé¢è·³è½¬

æˆ‘ä»¬æ–°å¢ä¸€ä¸ª`todocontent`é¡µé¢ï¼Œæ–¹ä¾¿æˆ‘ä»¬ç‚¹è¿›å»æŸ¥çœ‹æ¯ä¸€ä¸ªtodoçš„è¯¦æƒ…

ç„¶åä¿®æ”¹ä¸€ä¸‹é¡µé¢çš„åˆ—è¡¨æ¸²æŸ“ï¼Œå¢åŠ ä¸€ä¸ªç‚¹å‡»äº‹ä»¶

```vue
<view class="cu-item" 
:class="modalName=='move-box-'+ index?'move-cur':''" 
v-for="(todo,index) in todoList" 
:key="index"
@click="gotoContent(todo._id)"
... ... 
```

å†™ä¸€ä¸‹è¿™ä¸ªäº‹ä»¶`gotoContent`,é¡µé¢ä¼ å‚å’Œç½‘é¡µçš„å½¢å¼å·®ä¸å¤š[æ–‡æ¡£](https://uniapp.dcloud.io/api/router?id=navigateto)

```javascript
gotoContent(_id) {
	uni.navigateTo({
		url: '../todocontent/todocontent?_id=' + _id
	});
},
```

ç„¶ååœ¨ `todocontent`è¿™ä¸ªé¡µé¢ä¸­æ¥å—è¿™ä¸ªå‚æ•°

```javascript
onLoad(e) {
	console.log(e._id);
},
```

### å†’æ³¡ç‚¹å‡»

ä¸Šé¢çš„åŠŸèƒ½å®ç°ä»¥åä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ­¤æ—¶æˆ‘ä»¬å†æ¬¡ç‚¹å‡»åˆ é™¤æˆ–è€…åˆ‡æ¢çš„æŒ‰é’®ï¼Œå°±ä¼šç›´æ¥è·³è½¬åˆ°å¦å¤–ä¸€ä¸ªé¡µé¢äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é˜»æ­¢è¿™ä¸ªç‚¹å‡»éƒ¨ä½çš„è·³è½¬äº‹ä»¶ï¼Œå¾ˆç®€å•

```vue
<view class="action" @click.stop="">
	<switch :checked="todo._status" @change="switchTodo" :data-_id="todo._id" />
</view>
<view class="move">
	<view class="bg-red" @click.stop="del(todo._id)">åˆ é™¤</view>
</view>
```

### ç½‘ç»œè¯·æ±‚

ä¸ºäº†æœ‰æ„æ€ä¸€ç‚¹ï¼Œæˆ‘ä»¬è¿™ä¸ªå…·ä½“çš„`content`çš„æ•°æ®å°†æ¨¡æ‹Ÿåç«¯è¿”å›

#### åˆ›å»ºæœåŠ¡ï¼ˆå°æŠ€å·§ğŸš²ï¼‰

æœ€æ–¹ä¾¿çš„å¼€å¯ä¸€ä¸ªæœåŠ¡å¯ä»¥ä½¿ç”¨vscodeçš„ `live server`æ’ä»¶

![image-20201006144356886](https://img.lookroot.cn/blog/202010/06/144357-393952.png)

æˆ‘ä»¬æ–°å»ºä¸ª`todolist.json`æ–‡ä»¶

```json
[
    {
        "_name": "ç¬¬ä¸€ä»¶äº‹",
        "_id":1,
        "_status":false,
        "_time":1601956497000,
        "_content":"èŠ±èŠ±ä¸–ç•Œè¿·äººçœ¼,æ²¡æœ‰å®åŠ›åˆ«èµ›è„¸ã€‚"
    },
    {
        "_name": "ç¬¬äºŒä»¶äº‹",
        "_id":2,
        "_status":false,
        "_time":1601956497000,
        "_content":"å¤©çƒ­è„¾æ°”èº,æˆ‘ä¸å¾®ç¬‘ä½ åˆ«é—¹ã€‚"
    },
    {
        "_name": "ç¬¬ä¸‰ä»¶äº‹",
        "_id":3,
        "_status":false,
        "_time":1601956497000,
        "_content":"æ±Ÿå—æ±ŸåŒ—ä¸€æ¡è¡—,æ‰“å¬æ‰“å¬è°æ˜¯çˆ¹ã€‚"
    }
]
```

è¿™é‡Œæœ‰ä¸ªæ—¶é—´æˆ³å¯¹å§ï¼Œå†ä»‹ç»ä¸€ä¸ªå°æŠ€å·§ğŸš²ï¼Œæˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­å®šä¹‰è¿™æ ·çš„è„šæœ¬

![image-20201006145505964](https://img.lookroot.cn/blog/202010/06/145506-672070.png)

ç„¶åæŒ‰`ctrl + p`ä½¿ç”¨å¿«æ·è¿è¡Œè¿™ä¸ªå‘½ä»¤

![image-20201006145543464](https://img.lookroot.cn/blog/202010/06/145544-424191.png)

![image-20201006145644892](https://img.lookroot.cn/blog/202010/06/145645-439965.png)

æƒ³æŸ¥çœ‹æ›´å¤šçš„æµè§ˆå™¨æŠ€å·§å—[æµè§ˆå™¨è°ƒè¯•](https://www.lookroot.cn/course/chromedevtools/)

éšä¾¿åˆ›å»ºä¸€ä¸ª`html`æ–‡ä»¶ç„¶åä½¿ç”¨`live server`æ‰“å¼€

![image-20201006144427988](https://img.lookroot.cn/blog/202010/06/144428-320961.png)

æ¥ç€æˆ‘ä»¬åœ¨åœ°å€æ æ‰¾åˆ°æˆ‘ä»¬çš„jsonæ–‡ä»¶ï¼ŒæœåŠ¡å¯åŠ¨æˆåŠŸï¼

![image-20201006144454405](https://img.lookroot.cn/blog/202010/06/144455-945355.png)

#### è¯·æ±‚æ•°æ®

æˆ‘ä»¬å¼€å§‹åœ¨`todocontent`è¿™ä¸ªé¡µé¢è¯·æ±‚æ•°æ®äº†

é¦–å…ˆæˆ‘ä»¬è¦`onLoad`é‡Œé¢è¿›è¡Œè¯·æ±‚

```javascript
onLoad(e) {
	this.loadData(parseInt(e._id));
},
```

å†™ä¸€ä¸‹è¿™ä¸ª`loadData`

```javascript
loadData(_id) {
	this.getTodoById(_id);
},
```

è¿˜ç”¨å®šä¹‰ä¸€ä¸ªé»˜è®¤çš„ç©ºçš„todoå¯¹è±¡

```javascript
todo: {
	_id: -1,
	_name: "null",
	_status: false,
	_time: null,
	_content: "null"
},
```

å†™ä¸€ä¸‹è¿™ä¸ª`getTodoById`ä½¿ç”¨`uni.request`è¯·æ±‚æ•°æ®ï¼Œè¿™é‡Œä½¿ç”¨ `promise`çš„æ–¹å¼ç¨å¾®å†™å¤æ‚ä¸”æ²¡æœ‰æ„ä¹‰ï¼Œå•çº¯å°±æ˜¯ä¸ºäº†ç»™å¤§å®¶æ¨¡æ‹Ÿä¸€ä¸ªå®é™…å¼€å‘çš„å¸¸è§„è¯·æ±‚

```javascript
async getTodoById(_id) {
	uni.showLoading();
	const value = await uni.request({
		url: 'http://127.0.0.1:5500/todolist.json'
	}).then(data => {
		uni.hideLoading();
		var [error, res] = data;
		if (error != null | res == null) {
			this.toast("ç½‘ç»œå¼‚å¸¸", 1000, false)
			return Promise.resolve(this.todo);
		}
		if (res.data.length > 0) {
			const todo = res.data.find(todo => {
				return todo._id === _id;
			})
			return Promise.resolve(todo);
		}
	});
	this.todo = value;
}
```

#### æ¸²æŸ“æ•°æ®

è¿˜æ˜¯åƒä¸Šé¢ä¸€ä¸‹å»æ‹·è´ä¸€ä¸ªé¡µé¢è¿‡æ¥

```vue
<view class="flex justify-start align-center">
	<view class="text-sl">
		{{todo._name}}
	</view>
	<view class="margin-left-sm">
		{{todo._time}}
	</view>
	<view class="margin-left-sm">
		<switch :checked="todo._status" disabled="" />
	</view>
</view>
<view class="text-xl text-gray margin-top-sm">
	{{todo._content}}
</view>
<view class="padding flex flex-direction">
	<button @click="del" class="cu-btn bg-red margin-tb-sm lg">åˆ é™¤</button>
</view>
```

![image-20201006145325764](https://img.lookroot.cn/blog/202010/06/145326-800413.png)

#### è¿‡æ»¤å™¨

ä¸Šé¢çš„æ—¶é—´è¿˜æ˜¯æ—¶é—´æˆ³è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿‡æ»¤å™¨æ¥è½¬æ¢ä¸€ä¸‹

æ¥åˆ°`main.js`ä¸­ï¼Œè¿™é‡Œçš„æ—¶é—´æˆ³ç¨å¾®å†™çš„ç¹æ‚ä¸€ç‚¹ï¼Œä½†æ˜¯å¾ˆå®ç”¨ï¼Œå¯ä»¥è‡ªå®šä¹‰è¿”å›

```javascript
//è¡¥ä½
function formatNumber(n) {
	n = n.toString()
	return n[1] ? n : '0' + n;
}
// æ—¶é—´æˆ³è½¬æ¢æ—¥æœŸ
function formatTime(number, format) {
	if (!number || number == null) {
		return null;
	}
	let time = new Date(number);
	let newArr = []
	let formatArr = ['Y', 'M', 'D', 'h', 'm']
	newArr.push(time.getFullYear())
	newArr.push(formatNumber(time.getMonth() + 1))
	newArr.push(formatNumber(time.getDate()))
	newArr.push(formatNumber(time.getHours()))
	newArr.push(formatNumber(time.getMinutes()))
	for (let i in newArr) {
		format = format.replace(formatArr[i], newArr[i])
	}
	return format;
}
Vue.filter('strtotime', function(msg, arg) {
	return formatTime(msg, 'Y-M-D');
})
```

ä½¿ç”¨å®ƒ

```vue
<view class="margin-left-sm">
	{{todo._time|strtotime}}
</view>
```

![image-20201006145351729](https://img.lookroot.cn/blog/202010/06/145352-525136.png)

### é¡µé¢é€šä¿¡

è¿™é‡Œæœ‰ä¸ªåˆ é™¤äº‹ä»¶ï¼Œå¯ä»¥é€šè¿‡ [é¡µé¢é€šä¿¡](https://uniapp.dcloud.io/collocation/frame/communication)æ¥é€šçŸ¥ä¸Šä¸€ä¸ªé¡µé¢åˆ é™¤è¿™ä¸ªæ•°æ®

å®šä¹‰ä¸€ä¸‹è¿™ä¸ª`del`

```javascript
del() {
	uni.$emit('del_todo', {
		_id: this.todo._id
	});
    //åˆ é™¤å®Œæˆåè¿”å›ä¸Šä¸€é¡µ
	uni.navigateBack();
},
```

ç„¶ååœ¨ä¸Šä¸€ä¸ªé¡µé¢ä¸­ç›‘å¬äº‹ä»¶

```javascript
onLoad() {
	const todolist = uni.getStorageSync("todolist")
	if (todolist != "") {
		this.todoList = uni.getStorageSync("todolist");
	} else {
		this.todoList = this.staticTodoList;
	}
	uni.$on('del_todo', (data) => {
		this.del(data._id);
	})
},
```

### ä¸‹æ‹‰åˆ·æ–°

å¦‚æœæˆ‘ä»¬æƒ³æ¢å¤æœ€åŸæœ¬çš„æ•°æ®ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªä¸‹æ‹‰åˆ·æ–°äº‹ä»¶

é¦–å…ˆéœ€è¦å¼€å¯`page.json`ä¸­çš„é…ç½®`enablePullDownRefresh`

```json
"style": {
	"navigationBarTitleText": "uni-app",
	"navigationStyle": "custom",
	"usingComponents": {
		"wxcomdemo":"/wxcomponents/wxcomdemo/index"
	},
	"enablePullDownRefresh":true
}
```

ç„¶ååœ¨é¡µé¢ä¸­é‡æ–°è¿™ä¸ªäº‹ä»¶

```javascript
onPullDownRefresh() {
	uni.setStorageSync("todolist", "")
	this.todoList=this.staticTodoList
	uni.stopPullDownRefresh();
},
```

å®Œæˆï¼

## æ¡ä»¶ç¼–è¯‘

æ¡ä»¶ç¼–è¯‘å°±æ˜¯æŸäº›å†…å®¹åªåœ¨æŸä¸ªæˆ–è€…æŸäº›å¹³å°ç¼–è¯‘å±•ç¤º

### æ¨¡æ¿ä¸­çš„æ¡ä»¶ç¼–è¯‘

æ¯”å¦‚æˆ‘åªæƒ³åœ¨å¾®ä¿¡å°ç¨‹åºä¸­å±•ç¤ºè¿™ä¸ªå†…å®¹å¯ä»¥ä½¿ç”¨ `ifdef`

```
<!-- #ifdef MP-WEIXIN -->
mp-weixin
<!-- #endif -->
```

å¦‚æœæ˜¯æƒ³é™¤äº†å¾®ä¿¡å°ç¨‹åºè¿™ä¸ªå¹³å°ä¸æ˜¾ç¤ºï¼Œå…¶ä»–çš„éƒ½ä½¿ç”¨å‘¢ï¼Ÿä½¿ç”¨`ifndef `å°±å¯ä»¥äº†

### æ ·å¼ä¸­çš„æ¡ä»¶ç¼–è¯‘

```css
<style lang="less">
	/*  #ifdef  MP-WEIXIN  */
	.content {
		color: #DD524D;
	}

	/*  #endif  */
</style>
```

## æœªå®Œå¾…ç»­ï¼ï¼ï¼ï¼